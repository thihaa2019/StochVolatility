"0","one_mh_iteration <- function(sigma, current){"
"0","  "
"0","  proposal <- rnorm(1, mean = current, sd = sigma)"
"0","  "
"0","  if (proposal < 0) {"
"0","    alpha <- 0"
"0","    "
"0","  } else {"
"0","    "
"0","    proposal_plaus <- dgamma(proposal, 1, 1) * dpois(0, proposal)"
"0","    "
"0","    current_plaus <- dgamma(current, 1, 1) * dpois(0, current)"
"0","    "
"0","    alpha <- min(1, proposal_plaus/current_plaus)"
"0","  }   "
"0","  "
"0","  next_stop <- sample(c(proposal, current), "
"0","                      size = 1,"
"0","                      prob = c(alpha, 1-alpha))"
"0",""
"0",""
"0","  return(data.frame(proposal, alpha, next_stop))"
"0","  "
"0","} #end of one_mh_iteration function"
